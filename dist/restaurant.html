<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#3367D6">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
    <link rel="dns-prefetch" href="https://maps.googleapis.com" />
    <link rel="preconnect" href="http://127.0.0.1:1337" />
    <!-- Normalize.css for better cross-browser consistency -->
    <link rel="stylesheet" src="//normalize-css.googlecode.com/svn/trunk/normalize.css" />
    <!-- Main CSS file -->
    <style>@charset "utf-8";body,p,td,th{font-family:Arial,Helvetica,sans-serif;font-size:10pt;line-height:1.5}html{overflow-x:hidden}body{background-color:#fdfdfd;margin:0;position:relative;overflow-x:hidden}li,ul{font-family:Arial,Helvetica,sans-serif;font-size:10pt;color:#333}a{color:orange;text-decoration:none}a:focus,a:hover{color:#3397db;text-decoration:none}a img{border:none 0 #fff}@-moz-document url-prefix(){img:-moz-loading{visibility:hidden}}h1,h2,h3,h4,h5,h6{font-family:Arial,Helvetica,sans-serif;margin:0 0 20px}article,aside,canvas,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}#skipLink{position:absolute;top:-10000px}#maincontent{background-color:#f3f3f3;min-height:100%;display:grid}.restaurantcontent{grid-template-areas:"map" "restaurant" "review"}#footer{background-color:#444;color:#aaa;font-size:8pt;letter-spacing:1px;padding:25px;text-align:center;text-transform:uppercase;width:100%}#footer-info{margin:0;width:95%;color:#fff}nav{width:100%;height:80px;background-color:#252831;text-align:center}nav h1{margin:auto;width:90%}nav h1 a{color:#fff;font-size:14pt;font-weight:200;letter-spacing:10px;text-transform:uppercase}.nav-title{padding:1em}#breadcrumb{padding:10px 40px 16px;list-style:none;background-color:#eee;font-size:17px;margin:0;width:calc(100% - 10px)}#breadcrumb li{display:inline}#breadcrumb li+li:before{padding:8px;color:#000;content:"/\00a0"}#breadcrumb li a{color:#0275d8;text-decoration:none}#breadcrumb li a:hover{color:#01447e;text-decoration:underline}#map{height:400px;width:100%;background-color:#ccc}.filter-options{width:100%;height:5.5em;background-color:#252831;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:1em 2em;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;height:initial}.filter-options h2{color:#fff;font-size:1rem;font-weight:400;line-height:1;margin:0 20px}.filter-options select{background-color:#fff;border:1px solid #fff;font-family:Arial,sans-serif;font-size:11pt;height:35px;letter-spacing:0;margin:10px;padding:0 10px;width:200px}#restaurants-list{background-color:#f3f3f3;list-style:outside none none;margin:0 auto;padding:30px 15px 60px;text-align:center;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-preferred-size:auto;flex-basis:auto;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;flex-direction:initial;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:5%}#restaurants-list li{background-color:#fff;border:2px solid #ccc;font-family:Arial,sans-serif;margin:15px;min-height:380px;padding:0 30px 25px;text-align:left;width:270px;padding:1em 1em}#restaurants-list .restaurant-img{background-color:#ccc;display:block;margin:0;max-width:100%;min-height:248px;min-width:100%}#restaurants-list li h3{color:#000;font-family:Arial,sans-serif;font-size:14pt;font-weight:200;letter-spacing:0;line-height:1.3;margin:20px 0 10px;text-transform:uppercase}#restaurants-list p{margin:0;font-size:11pt}#restaurants-list li a{background-color:orange;border-bottom:3px solid #eee;color:#000;display:inline-block;font-size:10pt;margin:15px 0 0;padding:8px 30px 10px;text-align:center;text-decoration:none;text-transform:uppercase}#restaurant-info{padding-left:1em}.favorite{border:0;outline:0}.inside header{position:fixed;top:0;width:100%;z-index:1000}.inside #map-container{background:#00f none repeat scroll 0 0;height:29em;width:90%;grid-area:map}.inside #map{background-color:#ccc;height:100%;width:100%}.inside #footer{bottom:0;position:absolute}#restaurant-name{grid-area:name;color:#f18200;font-family:Arial,sans-serif;font-size:20pt;font-weight:200;letter-spacing:0;margin:15px 0 30px;text-transform:uppercase;line-height:1.1}.restaurant-img{width:90%;border-radius:15px 0 15px 0}#restaurant-address{font-size:12pt;margin:10px 0}#restaurant-cuisine{background-color:#333;color:#ddd;font-size:12pt;font-weight:300;letter-spacing:10px;margin:0 0 20px;padding:2px 0;text-align:center;text-transform:uppercase;width:90%}#restaurant-container{grid-area:restaurant}#restaurant-container,#reviews-container{border-bottom:1px solid #d9d9d9;border-top:1px solid #fff;padding:140px 40px 30px;width:90%}#reviews-container{padding:30px 40px 80px;grid-area:review}#reviews-container h2{color:#f58500;font-size:24pt;font-weight:300;letter-spacing:-1px;padding-bottom:1pt}#reviews-list{margin:0;padding:0}#reviews-list li{grid-area:reviews-list;background-color:#fff;border:2px solid #f3f3f3;display:block;list-style-type:none;margin:0 0 30px;overflow:hidden;position:relative;width:85%;border-radius:15px 0 15px 0}#reviews-list li p{padding:.4em;font-size:1.2em;margin:0}#restaurant-hours td{color:#666}.review-heading{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;background-color:#000;color:#fff;padding:0 .4em;margin-bottom:1em;border-radius:15px 0 0 0}.reviewHeader{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:85%;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.reviewsHeader h2{height:30px}#addReviewModal{display:none;width:400px;position:fixed;background-color:rgba(192,192,192,.7);height:200px;left:30vw;top:20vw;z-index:99}.reviewForm{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.reviewForm>input{margin:1.2em 1em}.addReviewsButton{width:9em;height:3em;background-color:orange;font-size:1.4em}.review-name{color:#fff}.review-date{font-size:1.2em;color:gray}.review-info{margin:0 1.5em}.review-rating{background-color:orange;color:#fff;text-align:center;padding:.2em;max-width:6em;border-radius:8%;margin-left:1em}.review-comment{color:gray}@media (max-width:480px){.filter-options{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;height:initial;padding:1em 0}#reviews-list li p{font-size:1em}}@media (max-width:720px){#restaurant-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:inherit}.inside #map-container{width:125%}}@media (min-width:720px){#restaurant-container{display:-webkit-box;display:-ms-flexbox;display:flex}.inside #map-container{height:auto}}</style>
    <title>Restaurant Information</title>
</head>

<body class="inside">
    <!-- Hidden Modal -->
        <div id="addReviewModal">
            <form class="reviewForm">
                    <label for="name">
                            Name: <input type="text" id="name" name="user_name">
                    </label>
                    <label for="rating">
                            Rating: <input type="text" id="rating" name="rating">
                    </label>
                    <label for="comments">
                            Comments: <input type="textarea" id="comments" name="comments">
                    </label>
                    <p> <button type="submitReview" id="submitReview">Submit Review</button> </p>
                    <p> <button id="cancelReview">Cancel</button> </p>
            </form>
        </div>
    <!-- Beginning header -->

    <header>
        <a href="#maincontent" id="skipLink">Skip to main content</a>
        <!-- Beginning nav -->

        <nav>
            <h1 class="nav-title"><a href="/">Restaurant Reviews</a></h1>
        </nav>
        <!-- Beginning breadcrumb -->
        <ol id="breadcrumb" aria-label="breadcrumb">
            <li><a href="/">Home</a></li>
        </ol>


        <!-- End breadcrumb -->
        <!-- End nav -->
    </header>
    <!-- End header -->

    <!-- Beginning main -->
    <main id="maincontent" class="restaurantcontent">
        <!-- Beginning map -->

        <!-- End map -->
        <!-- Beginning restaurant -->
        <section id="restaurant-container">
            <section id="restaurant-info">
                <h2 id="restaurant-name"></h2>
                <img id="restaurant-img">
                <p id="restaurant-cuisine"></p>
                <p id="restaurant-address"></p>
                <table id="restaurant-hours"></table>
            </section>
            <section id="map-container">
                <div id="map"></div>
            </section>

        </section>
        <!-- end restaurant -->
        <!-- Beginning reviews -->
        <section id="reviews-container">
            <ul id="reviews-list"></ul>
        </section>
        <!-- End reviews -->
    </main>
    <!-- End main -->

    <!-- Beginning footer -->
    <footer id="footer">
        Copyright (c) 2017 <a href="/"><strong>Restaurant Reviews</strong></a> All Rights Reserved.
    </footer>
    <!-- End footer -->

    <!-- Main javascript file -->
    <script type="text/javascript">class DBHelper{static get DATABASE_URL(){return"http://127.0.0.1:1337/restaurants"}static fetchRestaurants(e){var t=new Worker("../worker.js");t.postMessage({url:this.DATABASE_URL,store:"restaurants"}),t.onmessage=(t=>{var n=t.data;return e(null,n)})}static fetchRestaurantById(e,t){DBHelper.fetchRestaurants((n,a)=>{if(n)t(n,null);else{const n=a.find(t=>t.id==e);n?t(null,n):t("Restaurant does not exist",null)}})}static fetchRestaurantByCuisine(e,t){DBHelper.fetchRestaurants((n,a)=>{if(n)t(n,null);else{const n=a.filter(t=>t.cuisine_type==e);t(null,n)}})}static fetchRestaurantByNeighborhood(e,t){DBHelper.fetchRestaurants((n,a)=>{if(n)t(n,null);else{const n=a.filter(t=>t.neighborhood==e);t(null,n)}})}static fetchRestaurantByCuisineAndNeighborhood(e,t,n){DBHelper.fetchRestaurants((a,r)=>{if(a)n(a,null);else{let a=r;"all"!=e&&(a=a.filter(t=>t.cuisine_type==e)),"all"!=t&&(a=a.filter(e=>e.neighborhood==t)),n(null,a)}})}static fetchNeighborhoods(e){DBHelper.fetchRestaurants((t,n)=>{if(t)e(t,null);else{const t=n.map((e,t)=>n[t].neighborhood),a=t.filter((e,n)=>t.indexOf(e)==n);e(null,a)}})}static fetchCuisines(e){DBHelper.fetchRestaurants((t,n)=>{if(t)e(t,null);else{const t=n.map((e,t)=>n[t].cuisine_type),a=t.filter((e,n)=>t.indexOf(e)==n);e(null,a)}})}static urlForRestaurant(e){return`./restaurant.html?id=${e.id}`}static imageUrlForRestaurant(e){return`/img/${e.photograph}`}static mapMarkerForRestaurant(e,t){return new google.maps.Marker({position:e.latlng,title:e.name,url:DBHelper.urlForRestaurant(e),map:t,animation:google.maps.Animation.DROP})}static restaurantIsFavorite(e,t){fetch(`http://localhost:1337/restaurants/${e}/?is_favorite=true`,{method:"PUT"}).then(()=>{console.log("look, its your favorite")})}static restaurantNotFavorite(e,t){fetch(`http://localhost:1337/restaurants/${e}/?is_favorite=false`,{method:"PUT"})}static fetchRestaurantReviews(e,t){var n=new Worker("../worker.js");n.postMessage({url:`http://localhost:1337/reviews/?restaurant_id=${e}`,store:"reviews"}),n.onmessage=(e=>{var n=e.data;return t(null,n)})}static sendRestaurantReview(e,t,n,a,r){const s={restaurant_id:e,name:t,rating:n,comments:a};fetch("http://localhost:1337/reviews/",{headers:{"Content-Type":"application/form-data"},method:"POST",body:JSON.stringify(s)}).then(()=>{console.log("updated")})}}let restaurant;var map;window.initMap=(()=>{fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})}),fetchRestaurantFromURL=(e=>{if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(t,n)=>{self.restaurant=n,n?(fillRestaurantHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),fillRestaurantHTML=((e=self.restaurant)=>{document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;const t=document.getElementById("restaurant-img");t.className="restaurant-img",t.src=`/images/${e.id}-270.jpg`,t.alt="An image of the restaurant "+e.name,t.srcset=`/images/${e.id}-270.jpg 300w, /images/${e.id}-600.jpg 600w`,document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),DBHelper.fetchRestaurantReviews(e.id,fillReviewsHTML)}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let n in e){const a=document.createElement("tr"),r=document.createElement("td");r.innerHTML=n,a.appendChild(r);const s=document.createElement("td");s.innerHTML=e[n],a.appendChild(s),t.appendChild(a)}}),fillReviewsHTML=((e,t)=>{self.restaurant.reviews=t,console.log(self.restaurant.reviews);const n=document.getElementById("reviews-container"),a=document.createElement("div");a.className="reviewHeader",n.appendChild(a);const r=document.createElement("h2");r.innerHTML="Reviews",a.appendChild(r);const s=document.createElement("button");s.className="addReviewsButton",s.innerHTML="Add a Review",a.appendChild(s);const l=document.getElementById("addReviewModal"),i=document.getElementById("maincontent");if(s.addEventListener("click",e=>{l.style.display="block",i.style.opacity=".3"}),document.getElementById("cancelReview").addEventListener("click",e=>{e.preventDefault(),l.style.display="none",i.style.opacity="1"}),document.getElementById("submitReview").addEventListener("click",e=>{e.preventDefault();const t=document.getElementById("name").value,n=document.getElementById("rating").value,a=document.getElementById("comments").value;DBHelper.sendRestaurantReview(self.restaurant.id,t,n,a,(e,r)=>{e?console.log("Error saving review"):(console.log(r),console.log(t,n,a),window.location.href=`/restaurant.html?id=${self.restaurant.id}`)})}),!t){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void n.appendChild(e)}const o=document.getElementById("reviews-list");t.forEach(e=>{o.appendChild(createReviewHTML(e))}),n.appendChild(o)}),createReviewHTML=(e=>{const t=document.createElement("li"),n=document.createElement("div");t.appendChild(n);const a=document.createElement("p");a.innerHTML=`Author: ${e.name}`,a.className="review-name",n.className="review-heading",n.appendChild(a);const r=document.createElement("p");reviewDate=new Date(e.createdAt),console.log(reviewDate),displayDate=`${reviewDate.getDay()}/${reviewDate.getDate()}/${reviewDate.getFullYear()}`,r.innerHTML=`Date: ${displayDate}`,r.className="review-date",n.appendChild(r);const s=document.createElement("div");s.className="review-info";const l=document.createElement("p");l.innerHTML=`Rating: ${e.rating}`,l.className="review-rating",t.appendChild(s),s.appendChild(l);const i=document.createElement("p");return i.innerHTML=`${e.comments}`,i.className="review-comment",s.appendChild(i),t}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,n.setAttribute("aria-current","page"),t.appendChild(n)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}),"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").then(function(e){console.log("Registration succeeded. Scope is "+e.scope)}).catch(function(e){console.log("Registration failed with "+e)}),navigator.serviceWorker.ready.then(function(e){return e.sync.register("myFirstSync")});</script>
    <!-- Google Maps -->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBoMtReqrjzZfl-ubFwu7eCTxQhNccmo0w&libraries=places&callback=initMap"></script>

</body>

</html>